<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
    <title>FortiGate CLI Administration | MSP Training Platform</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Complete guide to FortiGate CLI administration including commands, configuration, and troubleshooting techniques." />
    <meta name="author" content="Velocity Lab" />
    <meta name="date" content="2025-07-17T14:13:00Z" />

    <!-- Preload images -->
    <link rel="preload" href="/assets/Velocity-Logo.png" as="image">
    <link rel="preload" href="/assets/VelocityBackground.jpg" as="image">

    <style>
        :root {
            --primary: #00a8ff;
            --primary-hover: #0093e6;
            --secondary: #f8f9fa;
            --background: #ffffff;
            --surface: #f8f9fa;
            --surface-hover: #e9ecef;
            --text: #1d1d1f;
            --text-secondary: #6e6e73;
            --border: #d2d2d7;
            --success: #34c759;
            --warning: #ff9500;
            --danger: #ff3b30;
            --shadow: rgba(0, 0, 0, 0.08);
            --shadow-heavy: rgba(0, 0, 0, 0.15);
            --jedi-glow: #00ff88;
            --sith-glow: #ff0066;
            --bg-secondary: #f0f0f5;
        }

        [data-theme="dark"] {
            --primary: #00a8ff;
            --primary-hover: #0093e6;
            --secondary: #1e1e1e;
            --background: #000000;
            --surface: #1e1e1e;
            --surface-hover: #2e2e2e;
            --text: #ffffff;
            --text-secondary: #a1a1a6;
            --border: #2e2e2e;
            --success: #30d158;
            --warning: #ff9f0a;
            --danger: #ff453a;
            --shadow: rgba(255, 255, 255, 0.1);
            --shadow-heavy: rgba(255, 255, 255, 0.2);
            --bg-secondary: #2a2a2a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
            transition: all 0.3s ease;
            scroll-behavior: smooth;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('/assets/VelocityBackground.jpg') center/cover no-repeat;
            opacity: 0.08;
            z-index: -1;
        }

        [data-theme="dark"] body::before {
            opacity: 0.05;
        }

        /* Access Denied Screen */
        .access-denied {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 2rem;
            background: var(--background);
        }

        .access-denied.hidden {
            display: none;
        }

        .access-denied-title {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--danger);
        }

        .access-denied-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            max-width: 600px;
        }

        .access-denied-button {
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            transition: all 0.2s ease;
        }

        .access-denied-button:hover {
            background: var(--primary-hover);
            transform: translateY(-1px);
        }

        /* Main Content */
        .main-wrapper {
            display: none;
        }

        .main-wrapper.authenticated {
            display: block;
        }

        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 9999;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            transition: all 0.3s ease;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--background);
            z-index: -2;
        }

        .header::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 1px solid var(--border);
            z-index: -1;
        }

        [data-theme="dark"] .header::after {
            background: rgba(0, 0, 0, 0.8);
        }

        .logo {
            width: 80px;
            height: 80px;
            background: url('/assets/Velocity-Logo.png') center/contain no-repeat;
            cursor: pointer;
            position: relative;
            z-index: 10001;
            transition: transform 0.2s ease;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        [data-theme="dark"] .logo {
            filter: invert(1) brightness(1.2);
        }

        .user-menu {
            position: relative;
        }

        .user-menu-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            background: none;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            color: var(--text);
            transition: all 0.2s ease;
        }

        .user-menu-toggle:hover {
            background: var(--surface-hover);
            transform: scale(1.05);
        }

        .user-menu-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 8px;
            box-shadow: 0 8px 25px var(--shadow-heavy);
            min-width: 200px;
            z-index: 9997;
            display: none;
        }

        .user-menu-dropdown.active {
            display: block;
            animation: dropdownSlide 0.2s ease;
        }

        @keyframes dropdownSlide {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-menu-item {
            display: block;
            width: 100%;
            padding: 12px 16px;
            text-align: left;
            background: none;
            border: none;
            color: var(--text);
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
        }

        .user-menu-item:hover {
            background: var(--surface-hover);
            transform: translateX(2px);
        }

        .theme-menu-item {
            position: relative;
        }

        .theme-menu-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            color: var(--text);
            border: none;
            background: none;
            width: 100%;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .theme-menu-toggle:hover {
            background: var(--surface-hover);
            transform: translateX(2px);
        }

        .theme-submenu {
            position: absolute;
            right: 100%;
            top: 0;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 8px;
            box-shadow: 0 8px 25px var(--shadow-heavy);
            min-width: 150px;
            z-index: 9996;
            display: none;
        }

        .theme-menu-item:hover .theme-submenu {
            display: block;
            animation: dropdownSlide 0.2s ease;
        }

        .theme-option {
            display: block;
            width: 100%;
            padding: 12px 16px;
            text-align: left;
            background: none;
            border: none;
            color: var(--text);
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            font-size: 14px;
        }

        .theme-option:hover {
            background: var(--surface-hover);
            transform: translateX(-2px);
        }

        .theme-option.active {
            background: var(--primary);
            color: white;
        }

        .theme-option.jedi:hover {
            background: linear-gradient(45deg, var(--jedi-glow), #00ff88);
            color: white;
        }

        .theme-option.sith:hover {
            background: linear-gradient(45deg, var(--sith-glow), #ff0066);
            color: white;
        }

        .main-container {
            margin-top: 70px;
            padding: 2rem;
            min-height: calc(100vh - 70px);
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .sidebar {
            width: 280px;
            background: var(--surface);
            padding: 1.5rem;
            position: fixed;
            height: calc(100% - 70px);
            overflow-y: auto;
            border-right: 1px solid var(--border);
            top: 70px;
            left: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px var(--shadow);
        }

        .sidebar h3 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .sidebar ul {
            list-style: none;
            padding: 0;
        }

        .sidebar ul li {
            margin-bottom: 0.5rem;
        }

        .sidebar ul li a {
            text-decoration: none;
            color: var(--text);
            display: block;
            padding: 0.75rem 1rem;
            transition: all 0.2s ease;
            border-radius: 8px;
            border-left: 3px solid transparent;
        }

        .sidebar ul li a:hover {
            color: var(--primary);
            background: var(--surface-hover);
            transform: translateX(4px);
            border-left-color: var(--primary);
        }

        .content {
            margin-left: 300px;
            padding: 0 0 2rem;
            max-width: 800px;
        }

        .content h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text);
            animation: fadeInUp 0.6s ease;
        }

        .content h2 {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 1.5rem 0 1rem;
            color: var(--text);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 0.5rem;
        }

        .content p {
            margin-bottom: 1rem;
            color: var(--text);
        }

        .content ul, .content ol {
            margin: 1rem 0 1rem 1.5rem;
            color: var(--text);
        }

        .content li {
            margin-bottom: 0.5rem;
        }

        .content .important {
            background: rgba(0, 168, 255, 0.1);
            border-left: 4px solid var(--primary);
            padding: 1rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }

        .content .important h4 {
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .content .warning {
            background: rgba(255, 149, 0, 0.1);
            border-left: 4px solid var(--warning);
            padding: 1rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }

        .content .warning h4 {
            color: var(--warning);
            margin-bottom: 0.5rem;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.2s ease;
            font-weight: 500;
            margin-bottom: 2rem;
        }

        .back-button:hover {
            background: var(--primary-hover);
            transform: translateY(-1px);
        }

        /* Code and pre styling */
        pre {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9rem;
            background: var(--surface);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            color: var(--text);
        }

        pre code {
            background: none;
            padding: 0;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: var(--background);
            border-radius: 8px;
            overflow: hidden;
        }

        table, th, td {
            border: 1px solid var(--border);
        }

        th, td {
            padding: 0.75rem;
            text-align: left;
            color: var(--text);
        }

        th {
            background: var(--surface);
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: var(--bg-secondary);
        }

        /* Command Reference Sections */
        .command-section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: var(--surface);
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }

        .command-section h4 {
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .command-example {
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 0.5rem;
            margin: 0.5rem 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9rem;
        }

        /* Footer */
        footer {
            background: var(--surface);
            padding: 1rem;
            text-align: center;
            border-top: 1px solid var(--border);
            margin-top: 2rem;
            border-radius: 8px 8px 0 0;
        }

        footer a {
            color: var(--primary);
            text-decoration: none;
            margin: 0 0.5rem;
            transition: color 0.2s ease;
        }

        footer a:hover {
            color: var(--primary-hover);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 0 1rem;
            }

            .sidebar {
                display: none;
            }

            .main-container {
                margin-top: 70px;
                padding: 1rem;
                margin-left: 0;
            }

            .content {
                margin-left: 0;
                max-width: 100%;
            }

            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body data-theme="dark">
    <!-- Access Denied Screen -->
    <div class="access-denied" id="accessDenied">
        <h1 class="access-denied-title">Access Denied</h1>
        <p class="access-denied-subtitle">
            You need to be logged in to access this tutorial content.<br>
            Please sign in to continue with your MSP training.
        </p>
        <a href="/" class="access-denied-button">Go to Login</a>
    </div>

    <!-- Main Content -->
    <div class="main-wrapper" id="mainWrapper">
        <header class="header">
            <div class="logo" onclick="window.location.href='/'"></div>
            
            <div class="user-menu">
                <button class="user-menu-toggle" onclick="toggleUserMenu()">
                    <span id="userName">User</span>
                    <span>▼</span>
                </button>
                <div class="user-menu-dropdown" id="userMenuDropdown">
                    <button class="user-menu-item" onclick="showAdminPanel()" id="adminButton" style="display: none;">Admin Panel</button>
                    <div class="theme-menu-item">
                        <button class="theme-menu-toggle">
                            <span>Theme</span>
                            <span>▶</span>
                        </button>
                        <div class="theme-submenu">
                            <button class="theme-option jedi" onclick="setTheme('light')">
                                Light Jedi
                            </button>
                            <button class="theme-option sith active" onclick="setTheme('dark')">
                                Dark Sith
                            </button>
                        </div>
                    </div>
                    <button class="user-menu-item" onclick="logout()">Sign Out</button>
                </div>
            </div>
        </header>
        
        <div class="main-container">
            <aside class="sidebar">
                <h3>In this article</h3>
                <ul>
                    <li><a href="#overview">Overview</a></li>
                    <li><a href="#cli-basics">CLI Basics</a></li>
                    <li><a href="#navigation">Navigation</a></li>
                    <li><a href="#essential-commands">Essential Commands</a></li>
                    <li><a href="#configuration">Configuration</a></li>
                    <li><a href="#monitoring">Monitoring</a></li>
                    <li><a href="#troubleshooting">Troubleshooting</a></li>
                    <li><a href="#advanced-commands">Advanced Commands</a></li>
                    <li><a href="#next-steps">Next Steps</a></li>
                </ul>
            </aside>
            
            <main class="content">
                <a href="/assets/fortigate.html" class="back-button">← Back to FortiGate Guides</a>
                
                <h1>FortiGate CLI Administration</h1>
                <p>Last updated: July 17, 2025</p>
                <p>This comprehensive guide covers FortiGate CLI administration including navigation, essential commands, configuration management, and troubleshooting techniques.</p>
                
                <div class="important">
                    <h4>Important</h4>
                    <p>CLI commands can significantly impact system operation. Always verify commands before execution and maintain configuration backups.</p>
                </div>

                <h2 id="overview">Overview</h2>
                <p>The FortiGate CLI provides powerful command-line access to configure, monitor, and troubleshoot FortiGate devices. Understanding CLI fundamentals is essential for advanced administration and automation.</p>
                
                <h3>CLI Access Methods</h3>
                <ul>
                    <li><strong>Console Port:</strong> Direct serial connection to device</li>
                    <li><strong>SSH:</strong> Secure network access over IP</li>
                    <li><strong>Telnet:</strong> Legacy network access (not recommended)</li>
                    <li><strong>Web GUI CLI:</strong> CLI widget within web interface</li>
                </ul>
                
                <h2 id="cli-basics">CLI Basics</h2>
                <p>Understanding CLI structure, command syntax, and basic navigation is fundamental to effective FortiGate administration.</p>
                
                <div class="command-section">
                    <h4>Command Structure</h4>
                    <p>FortiGate CLI commands follow a hierarchical structure:</p>
                    <div class="command-example">
                        <strong>Format:</strong> [command] [sub-command] [parameters]<br>
                        <strong>Example:</strong> config system interface
                    </div>
                </div>
                
                <div class="command-section">
                    <h4>Command Types</h4>
                    <table>
                        <tr>
                            <th>Command Type</th>
                            <th>Purpose</th>
                            <th>Example</th>
                        </tr>
                        <tr>
                            <td>config</td>
                            <td>Enter configuration mode</td>
                            <td>config system global</td>
                        </tr>
                        <tr>
                            <td>get</td>
                            <td>Display configuration</td>
                            <td>get system status</td>
                        </tr>
                        <tr>
                            <td>show</td>
                            <td>Show configuration details</td>
                            <td>show firewall policy</td>
                        </tr>
                        <tr>
                            <td>execute</td>
                            <td>Execute operational commands</td>
                            <td>execute ping 8.8.8.8</td>
                        </tr>
                        <tr>
                            <td>diagnose</td>
                            <td>Diagnostic and troubleshooting</td>
                            <td>diagnose sys top</td>
                        </tr>
                    </table>
                </div>
                
                <div class="command-section">
                    <h4>Special Characters and Shortcuts</h4>
                    <table>
                        <tr>
                            <th>Character/Key</th>
                            <th>Function</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>?</td>
                            <td>Help</td>
                            <td>Shows available commands</td>
                        </tr>
                        <tr>
                            <td>Tab</td>
                            <td>Auto-complete</td>
                            <td>Completes command or parameter</td>
                        </tr>
                        <tr>
                            <td>Ctrl+C</td>
                            <td>Cancel</td>
                            <td>Cancels current command</td>
                        </tr>
                        <tr>
                            <td>Ctrl+Z</td>
                            <td>Logout</td>
                            <td>Exits CLI session</td>
                        </tr>
                        <tr>
                            <td>Arrow Keys</td>
                            <td>History</td>
                            <td>Navigate command history</td>
                        </tr>
                    </table>
                </div>

                <h2 id="navigation">Navigation</h2>
                <p>Efficient CLI navigation is crucial for productivity. Learn how to move between configuration contexts and access help.</p>
                
                <div class="command-section">
                    <h4>Basic Navigation Commands</h4>
                    <pre><code># Enter configuration mode
config system global

# Exit configuration mode
end

# Move up one level
next

# Show current context
pwd

# Show available commands
?

# Show command syntax
command ?

# Cancel current operation
abort</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Configuration Context Navigation</h4>
                    <pre><code># Enter system configuration
config system global
    # System-level settings
    set hostname "FortiGate-Lab"
    set timezone "GMT-5:00"
end

# Enter interface configuration
config system interface
    edit "port1"
        # Interface-specific settings
        set ip 192.168.1.1 255.255.255.0
        set allowaccess ping https ssh
    next
end

# Enter firewall policy configuration
config firewall policy
    edit 1
        # Policy-specific settings
        set srcintf "internal"
        set dstintf "port1"
    next
end</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Help and Documentation</h4>
                    <pre><code># Get help for current context
?

# Get help for specific command
get ?
config ?
execute ?

# Show command syntax
set ?
edit ?

# Show available parameters
set hostname ?
set timezone ?</code></pre>
                </div>

                <h2 id="essential-commands">Essential Commands</h2>
                <p>Master these essential commands for daily FortiGate administration tasks.</p>
                
                <div class="command-section">
                    <h4>System Information</h4>
                    <pre><code># Display system status
get system status

# Show system performance
get system performance status

# Display interface information
get system interface

# Show system configuration
show system global

# Display version information
get system version

# Show hardware information
get hardware status</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Network Information</h4>
                    <pre><code># Display routing table
get router info routing-table all

# Show interface statistics
get system interface ?

# Display ARP table
get system arp

# Show session information
get system session list

# Display IPSec status
get vpn ipsec tunnel summary

# Show DHCP lease information
get system dhcp status</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Security Information</h4>
                    <pre><code># Display firewall policies
get firewall policy

# Show security profiles
get system security-profile

# Display user information
get user info

# Show VPN status
get vpn status

# Display log information
get log statistics</code></pre>
                </div>

                <h2 id="configuration">Configuration</h2>
                <p>Learn how to configure FortiGate devices using CLI commands for various components.</p>
                
                <div class="command-section">
                    <h4>System Configuration</h4>
                    <pre><code># Configure system global settings
config system global
    set hostname "FortiGate-Branch"
    set timezone "GMT-5:00"
    set gui-theme mariner
    set admintimeout 60
    set admin-sport 443
    set admin-ssh-port 22
end

# Configure DNS settings
config system dns
    set primary 8.8.8.8
    set secondary 8.8.4.4
end

# Configure NTP
config system ntp
    set ntpsync enable
    set type fortiguard
end</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Interface Configuration</h4>
                    <pre><code># Configure WAN interface
config system interface
    edit "port1"
        set vdom "root"
        set mode dhcp
        set allowaccess ping https ssh
        set type physical
        set alias "WAN"
        set role wan
    next
end

# Configure LAN interface
config system interface
    edit "internal"
        set vdom "root"
        set ip 192.168.1.1 255.255.255.0
        set allowaccess ping https ssh telnet fgfm
        set type physical
        set alias "LAN"
        set role lan
    next
end</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Firewall Policy Configuration</h4>
                    <pre><code># Create firewall policy
config firewall policy
    edit 1
        set name "LAN_to_WAN"
        set srcintf "internal"
        set dstintf "port1"
        set srcaddr "all"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set nat enable
        set logtraffic all
    next
end

# Create address objects
config firewall address
    edit "Internal_Network"
        set subnet 192.168.1.0 255.255.255.0
        set comment "Internal LAN"
    next
end</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Configuration Management</h4>
                    <pre><code># Save configuration
execute backup config flash

# Restore configuration
execute restore config flash

# Factory reset
execute factoryreset

# Reboot system
execute reboot

# Show full configuration
show full-configuration

# Show specific configuration section
show firewall policy</code></pre>
                </div>

                <h2 id="monitoring">Monitoring</h2>
                <p>Use CLI commands to monitor system performance, network traffic, and security events.</p>
                
                <div class="command-section">
                    <h4>System Monitoring</h4>
                    <pre><code># Display system resource usage
diagnose sys top

# Monitor CPU usage
diagnose sys top-summary

# Check memory usage
diagnose hardware sysinfo memory

# Monitor disk usage
diagnose sys flash list

# Check system sensors
diagnose hardware sysinfo sensors

# Monitor processes
diagnose sys process list</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Network Monitoring</h4>
                    <pre><code># Monitor interface traffic
diagnose sys interface list

# Monitor network connections
diagnose sys session list

# Check bandwidth usage
diagnose sys bandwidth

# Monitor routing table changes
diagnose debug enable
diagnose debug application rtmd 255

# Monitor ARP table
diagnose sys arp list

# Check DNS resolution
diagnose test application dnsproxy 6</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Security Monitoring</h4>
                    <pre><code># Monitor firewall sessions
diagnose sys session list

# Check security profiles
diagnose sys security-profile list

# Monitor VPN connections
diagnose vpn tunnel list

# Check authentication events
diagnose debug application fnbamd 255

# Monitor IPS events
diagnose log read

# Check antivirus status
diagnose test application av 1</code></pre>
                </div>

                <h2 id="troubleshooting">Troubleshooting</h2>
                <p>Essential troubleshooting commands for diagnosing and resolving FortiGate issues.</p>
                
                <div class="warning">
                    <h4>Warning</h4>
                    <p>Debug commands can generate significant output and impact system performance. Use with caution in production environments.</p>
                </div>
                
                <div class="command-section">
                    <h4>Network Troubleshooting</h4>
                    <pre><code># Test connectivity
execute ping 8.8.8.8
execute ping-options source 192.168.1.1
execute ping6 2001:4860:4860::8888

# Trace network path
execute traceroute 8.8.8.8

# Test DNS resolution
execute nslookup google.com

# Monitor packet flow
diagnose sniffer packet any "host 192.168.1.100" 4 0 l

# Debug routing
diagnose debug enable
diagnose debug application rtmd 255

# Check interface status
diagnose netlink interface list</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>VPN Troubleshooting</h4>
                    <pre><code># Debug IPSec VPN
diagnose debug reset
diagnose debug enable
diagnose debug application ike 255
diagnose debug application ipsec 255

# Check IPSec tunnel status
diagnose vpn ipsec tunnel list

# Test IPSec connectivity
diagnose vpn ipsec tunnel up tunnel_name

# Debug SSL VPN
diagnose debug application sslvpn -1

# Check SSL VPN users
diagnose vpn ssl list

# Monitor VPN logs
diagnose log read | grep vpn</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Performance Troubleshooting</h4>
                    <pre><code># Check system performance
diagnose sys performance top

# Monitor memory usage
diagnose sys memory

# Check disk space
diagnose sys diskusage

# Monitor CPU usage per process
diagnose sys top-summary

# Check system logs
diagnose log read

# Monitor system calls
diagnose sys syscall</code></pre>
                </div>

                <h2 id="advanced-commands">Advanced Commands</h2>
                <p>Advanced CLI commands for complex administration tasks and system optimization.</p>
                
                <div class="command-section">
                    <h4>Advanced System Commands</h4>
                    <pre><code># Enter global VDOM context
config global

# Switch between VDOMs
config vdom
    edit "root"
        # VDOM-specific commands
    next
end

# Configure HA (High Availability)
config system ha
    set mode a-p
    set hbdev "port3" 50
    set session-pickup enable
    set session-pickup-connectionless enable
    set session-pickup-nat enable
    set session-pickup-expectation enable
    set override disable
end

# Configure link monitoring
config system link-monitor
    edit "wan_monitor"
        set srcintf "port1"
        set server "8.8.8.8"
        set protocol ping
        set interval 1
        set timeout 1
        set failtime 5
        set recoverytime 5
    next
end</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Scripting and Automation</h4>
                    <pre><code># Execute script from file
execute script run script_name

# Create configuration script
config system script
    edit "backup_config"
        set type cli
        set content "
            execute backup config flash
            execute log filter category 0
            execute log display
        "
    next
end

# Schedule script execution
config system automation-trigger
    edit "daily_backup"
        set trigger-type scheduled
        set trigger-frequency daily
        set trigger-hour 2
        set trigger-minute 0
    next
end</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Advanced Debugging</h4>
                    <pre><code># Enable comprehensive debugging
diagnose debug reset
diagnose debug duration 300
diagnose debug enable
diagnose debug application rtmd 255
diagnose debug application ike 255
diagnose debug application ipsec 255

# Debug specific modules
diagnose debug application fnbamd 255    # Authentication
diagnose debug application sslvpn -1     # SSL VPN
diagnose debug application httpsd 255    # Web interface
diagnose debug application fgd 255       # FortiGuard

# Monitor system calls
diagnose sys syscall enable
diagnose sys syscall disable

# Advanced packet capture
diagnose sniffer packet any "icmp" 4 100 a
diagnose sniffer packet port1 "tcp port 80" 6 0 l

# Check system integrity
diagnose sys checksum all</code></pre>
                </div>
                
                <div class="command-section">
                    <h4>Log Analysis</h4>
                    <pre><code># Real-time log monitoring
execute log display

# Filter logs by category
execute log filter category 0    # Traffic logs
execute log filter category 1    # UTM logs
execute log filter category 2    # Event logs

# Search logs
execute log filter field srcip 192.168.1.100
execute log filter field dstport 80
execute log filter field action deny

# Export logs
execute log archive-hourly
execute log archive-daily

# Clear log filters
execute log filter clear</code></pre>
                </div>

                <h2 id="next-steps">Next Steps</h2>
                <p>Continue expanding your FortiGate CLI skills with these advanced topics:</p>
                <ul>
                    <li><a href="/assets/fortigate-setup.html">FortiGate Initial Setup</a></li>
                    <li><a href="/assets/fortigate-policy.html">Advanced Policy Configuration</a></li>
                    <li><a href="/assets/fortigate-routing.html">Routing Configuration</a></li>
                    <li><a href="/assets/fortigate-ipsec.html">IPSec VPN Configuration</a></li>
                    <li><a href="/assets/fortigate-sslvpn.html">SSL VPN Configuration</a></li>
                    <li><a href="/assets/fortigate-sdwan.html">SD-WAN Configuration</a></li>
                </ul>
            </main>
        </div>
        
        <footer>
            <p><a href="/privacy">Privacy</a> | <a href="/terms">Terms of Use</a> | © Velocity Lab 2025</p>
        </footer>
    </div>

    <script>
        // Authentication state
        let userSession = null;
        let isAuthenticated = false;

        // Cookie utility functions
        const cookieUtils = {
            get(name) {
                const nameEQ = name + "=";
                const ca = document.cookie.split(';');
                for(let i = 0; i < ca.length; i++) {
                    let c = ca[i];
                    while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                    if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
                }
                return null;
            },
            delete(name) {
                document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=Strict`;
            }
        };

        // Check authentication status
        function checkAuthentication() {
            const userCookie = cookieUtils.get('user');
            const sessionCookie = cookieUtils.get('session');
            
            if (userCookie && sessionCookie) {
                try {
                    userSession = JSON.parse(userCookie);
                    isAuthenticated = true;
                    return true;
                } catch (error) {
                    console.error('Invalid user session data');
                    cookieUtils.delete('user');
                    cookieUtils.delete('session');
                    return false;
                }
            }
            return false;
        }

        // Show appropriate content based on authentication
        function showContent() {
            const accessDenied = document.getElementById('accessDenied');
            const mainWrapper = document.getElementById('mainWrapper');
            
            if (isAuthenticated) {
                accessDenied.classList.add('hidden');
                mainWrapper.classList.add('authenticated');
                
                // Set user name
                const userName = document.getElementById('userName');
                if (userName && userSession) {
                    userName.textContent = userSession.name || 'User';
                }
                
                // Show admin panel for admins
                if (userSession && userSession.role === 'admin') {
                    const adminButton = document.getElementById('adminButton');
                    if (adminButton) {
                        adminButton.style.display = 'block';
                    }
                }
            } else {
                accessDenied.classList.remove('hidden');
                mainWrapper.classList.remove('authenticated');
            }
        }

        // Theme management
        function setTheme(theme) {
            document.body.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            
            const themeOptions = document.querySelectorAll('.theme-option');
            themeOptions.forEach(option => {
                option.classList.remove('active');
                if ((theme === 'light' && option.classList.contains('jedi')) || 
                    (theme === 'dark' && option.classList.contains('sith'))) {
                    option.classList.add('active');
                }
            });
        }

        // Load saved theme
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.body.setAttribute('data-theme', savedTheme);
            
            const themeOptions = document.querySelectorAll('.theme-option');
            themeOptions.forEach(option => {
                option.classList.remove('active');
                if ((savedTheme === 'light' && option.classList.contains('jedi')) || 
                    (savedTheme === 'dark' && option.classList.contains('sith'))) {
                    option.classList.add('active');
                }
            });
        }

        // User menu toggle
        function toggleUserMenu() {
            const dropdown = document.getElementById('userMenuDropdown');
            dropdown.classList.toggle('active');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const userMenu = document.querySelector('.user-menu');
            const dropdown = document.getElementById('userMenuDropdown');
            if (userMenu && dropdown && !userMenu.contains(event.target) && dropdown.classList.contains('active')) {
                dropdown.classList.remove('active');
            }
        });

        // Navigation functions
        function showAdminPanel() {
            window.location.href = '/?admin=true';
        }

        function logout() {
            cookieUtils.delete('user');
            cookieUtils.delete('session');
            window.location.href = '/';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();
            
            if (checkAuthentication()) {
                showContent();
            } else {
                showContent();
            }
        });
    </script>
</body>
</html>