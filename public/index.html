<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Velocity Lab - Comprehensive MSP Training Platform</title>
    
    <!-- PWA Meta Tags -->
    <meta name="application-name" content="Velocity Lab">
    <meta name="apple-mobile-web-app-title" content="Velocity Lab">
    <meta name="description" content="Comprehensive MSP training platform covering Exchange Hybrid LAB plus tutorials for Networking, Azure, Firewalls, Linux, and more">
    <meta name="theme-color" content="#00a8ff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico">
    
    <!-- PWA Icons -->
    <link rel="apple-touch-icon" href="/assets/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/Appleios.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/assets/icon-512.png">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Open Graph for sharing -->
    <meta property="og:title" content="Velocity Lab - MSP Training Platform">
    <meta property="og:description" content="Exchange Hybrid LAB plus comprehensive tutorials covering Networking, Microsoft Azure, Firewalls, Linux, and more">
    <meta property="og:image" content="/assets/Android_512.png">
    <meta property="og:url" content="https://labverse.co.za">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Velocity Lab - MSP Training Platform">
    <meta name="twitter:description" content="Exchange Hybrid LAB plus comprehensive tutorials covering Networking, Microsoft Azure, Firewalls, Linux, and more">
    <meta name="twitter:image" content="/assets/Android_512.png">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="/assets/Velocity-Logo.png" as="image">
    <link rel="preload" href="/assets/VelocityBackground.jpg" as="image">
    <link rel="preload" href="/assets/css/main.css" as="style">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/components.css">
    <link rel="stylesheet" href="/assets/css/responsive.css">
</head>
<body data-theme="dark" class="no-scroll landing-page">
    <!-- Header -->
    <header class="header" id="header">
        <!-- Logo -->
        <div class="logo" onclick="goHome()" role="button" tabindex="0" aria-label="Velocity Lab Home"></div>
        
        <!-- Desktop Navigation - Only Request Access in header -->
        <div class="header-buttons" id="headerButtons">
            <button class="btn btn-primary" onclick="showRequestAccessModal()">Request Access</button>
        </div>
        
        <!-- Mobile Hamburger Menu -->
        <button class="hamburger" id="hamburger" onclick="toggleMobileMenu()" aria-label="Toggle Menu">
            <span></span>
            <span></span>
            <span></span>
        </button>
        
        <!-- Desktop User Menu -->
        <div class="user-menu hidden" id="userMenu">
            <button class="user-menu-toggle" onclick="toggleUserMenu()" aria-label="User Menu">
                <span id="userName">User</span>
                <span aria-hidden="true">▼</span>
            </button>
            <div class="user-menu-dropdown" id="userMenuDropdown" role="menu">
                <button class="user-menu-item" onclick="startLabEnvironment()" role="menuitem">Start New Lab</button>
                <button class="user-menu-item" onclick="showLabHistoryModal()" id="labHistoryButton" role="menuitem">Lab History</button>
                <button class="user-menu-item" onclick="showAdminPanel()" id="adminButton" style="display: none;" role="menuitem">Admin Panel</button>
                <div class="theme-menu-item">
                    <button class="theme-menu-toggle" role="menuitem" aria-haspopup="true">
                        <span>Theme</span>
                        <span aria-hidden="true">▶</span>
                    </button>
                    <div class="theme-submenu" role="menu">
                        <button class="theme-option jedi" onclick="setTheme('light')" role="menuitem">Light Jedi</button>
                        <button class="theme-option sith active" onclick="setTheme('dark')" role="menuitem">Dark Sith</button>
                    </div>
                </div>
                <button class="user-menu-item" onclick="logout()" role="menuitem">Sign Out</button>
            </div>
        </div>
    </header>

    <!-- Mobile Menu Overlay -->
    <nav class="mobile-menu" id="mobileMenu" role="navigation">
        <div class="mobile-menu-items" id="mobileMenuItems">
            <!-- Items populated by JavaScript based on auth state -->
        </div>
    </nav>

    <!-- Welcome Screen - Sign In button centered, Request Access below on mobile -->
    <main class="welcome-screen" id="welcomeScreen">
        <div class="welcome-notification" id="welcomeNotification">
            Welcome to Velocity Lab! Request access to begin your MSP training journey with our Exchange Hybrid LAB and comprehensive tutorials.
        </div>
        
        <h1 class="welcome-title">MSP Training Platform</h1>
        <p class="welcome-subtitle">
            Exchange Hybrid LAB + Comprehensive Tutorials<br>
            Professional development for managed service providers
        </p>
        
        <div class="welcome-buttons">
            <button class="btn btn-primary btn-large" onclick="showSignInModal()">
                Sign In
            </button>
            <!-- Mobile-only Request Access button - grey/transparent, below Sign In -->
            <button class="btn btn-secondary-mobile btn-large mobile-only" onclick="showRequestAccessModal()">
                Request Access
            </button>
        </div>
    </main>

    <!-- Main Dashboard -->
    <main class="main-content hidden" id="mainContent">
        <!-- Categories Grid (shows by default) -->
        <section class="categories-container" id="categoriesContainer">
            <!-- Category cards will be populated by JavaScript -->
        </section>

        <!-- Course View (shows when Exchange LAB is selected) -->
        <section class="course-view hidden" id="courseView">
            <!-- Progress Ring -->
            <div class="progress-section">
                <div class="progress-ring">
                    <svg viewBox="0 0 120 120" aria-hidden="true">
                        <circle class="progress-ring-bg" cx="60" cy="60" r="54"/>
                        <circle class="progress-ring-fill" cx="60" cy="60" r="54" 
                                stroke-dasharray="0 339.292" id="progressRing"/>
                    </svg>
                    <div class="progress-text">
                        <div class="progress-percentage" id="progressPercentage">0%</div>
                        <div class="progress-label">Complete</div>
                    </div>
                </div>
            </div>

            <!-- Week Cards -->
            <div class="weeks-container" id="weeksContainer">
                <!-- Week cards will be populated by JavaScript -->
            </div>
            
            <div class="navigation-controls">
                <button class="btn btn-secondary" onclick="showCategoriesView()">← Back to Categories</button>
            </div>
        </section>

        <!-- Tutorial View (shows when tutorial category is selected) -->
        <section class="tutorial-view hidden" id="tutorialView">
            <!-- Tutorial content will be populated by JavaScript -->
        </section>
    </main>

    <!-- Apple-style Sign In Modal -->
    <div class="modal" id="signInModal" role="dialog" aria-labelledby="signInTitle" aria-hidden="true">
        <div class="modal-content apple-modal">
            <button class="modal-close" onclick="closeModal('signInModal')" aria-label="Close">&times;</button>
            
            <!-- Clean header with logo -->
            <div class="modal-header-clean">
                <div class="modal-logo" aria-hidden="true"></div>
            </div>
            
            <div class="modal-body">
                <h2 class="modal-title" id="signInTitle">Sign in to Velocity Lab</h2>
                <p class="modal-subtitle">Welcome back to your training journey</p>
                
                <form id="signInForm" novalidate>
                    <div class="apple-form-group">
                        <label for="signInEmail" class="sr-only">Email Address</label>
                        <input type="email" class="apple-form-input" id="signInEmail" name="email" 
                               placeholder="Email" required autocomplete="email">
                    </div>
                    
                    <div class="apple-form-group hidden" id="passwordGroup">
                        <div class="password-field">
                            <label for="signInPassword" class="sr-only">Password</label>
                            <input type="password" class="apple-form-input" id="signInPassword" name="password" 
                                   placeholder="Password" required autocomplete="current-password">
                            <button type="submit" class="password-toggle" title="Sign In" aria-label="Sign In">
                                →
                            </button>
                        </div>
                    </div>
                    
                    <div class="apple-checkbox-container hidden" id="rememberGroup">
                        <input type="checkbox" class="apple-checkbox" name="remember" id="rememberMe">
                        <label class="apple-checkbox-label" for="rememberMe">Remember me for 30 days</label>
                    </div>
                    
                    <div id="signInMessage" role="alert" aria-live="polite"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Request Access Modal - Fixed for desktop display -->
    <div class="modal" id="requestAccessModal" role="dialog" aria-labelledby="requestAccessTitle" aria-hidden="true">
        <div class="modal-content large">
            <button class="modal-close" onclick="closeModal('requestAccessModal')" aria-label="Close">&times;</button>
            
            <div class="modal-header">
                <h2 id="requestAccessTitle">Request Training Access</h2>
                <p class="modal-subtitle">Join our comprehensive MSP training platform</p>
            </div>
            
            <div class="modal-body">
                <div class="request-form">
                    <h3>Access Request Form</h3>
                    <p>Please fill out the form below to request access to our training platform. Our team will review your request and create your account manually.</p>
                    
                    <form action="https://api.web3forms.com/submit" method="POST" id="requestAccessForm" novalidate>
                        <!-- Replace with your Access Key -->
                        <input type="hidden" name="access_key" value="fe37519c-2a4b-48ee-a090-1746e3ad0010">
                        
                        <!-- Form Inputs -->
                        <div class="form-group">
                            <label class="form-label" for="requestName">Full Name *</label>
                            <input type="text" class="form-input" id="requestName" name="name" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="requestEmail">Email Address *</label>
                            <input type="email" class="form-input" id="requestEmail" name="email" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="requestCompany">Company/Organization</label>
                            <input type="text" class="form-input" id="requestCompany" name="company">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="requestMessage">Tell us about your training goals *</label>
                            <textarea class="form-input form-textarea" id="requestMessage" name="message" required 
                                      placeholder="What specific areas are you interested in? (Exchange LAB, Networking, Azure, Firewalls, etc.)"></textarea>
                        </div>
                        
                        <!-- Honeypot Spam Protection -->
                        <input type="checkbox" name="botcheck" class="hidden" style="display: none;">
                        
                        <!-- Custom Confirmation / Success Page -->
                        <input type="hidden" name="redirect" value="https://labverse.co.za/thanks.html">
                        
                        <button type="submit" class="form-submit">Submit Access Request</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Task Detail Modal -->
    <div class="modal" id="taskDetailModal" role="dialog" aria-labelledby="taskDetailTitle" aria-hidden="true">
        <div class="modal-content large">
            <button class="task-detail-close" onclick="closeModal('taskDetailModal')" aria-label="Close">&times;</button>
            <div class="modal-header">
                <h2 id="taskDetailTitle">Task Details</h2>
            </div>
            <div class="task-detail-content" id="taskDetailContent">
                <!-- Task details will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Tutorial Detail Modal -->
    <div class="modal" id="tutorialDetailModal" role="dialog" aria-labelledby="tutorialDetailTitle" aria-hidden="true">
        <div class="modal-content large">
            <button class="modal-close" onclick="closeModal('tutorialDetailModal')" aria-label="Close">&times;</button>
            <div class="modal-header">
                <h2 id="tutorialDetailTitle">Tutorial Guide</h2>
            </div>
            <div class="task-detail-content" id="tutorialDetailContent">
                <!-- Tutorial details will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Lab History Modal -->
    <div class="modal" id="labHistoryModal" role="dialog" aria-labelledby="labHistoryTitle" aria-hidden="true">
        <div class="modal-content large">
            <button class="modal-close" onclick="closeModal('labHistoryModal')" aria-label="Close">&times;</button>
            <div class="modal-header">
                <h2 id="labHistoryTitle">Lab History</h2>
                <p class="modal-subtitle">Your Exchange Hybrid LAB progress timeline</p>
            </div>
            <div class="lab-history-modal-content" id="labHistoryModalContent">
                <!-- Lab history content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div class="modal" id="adminModal" role="dialog" aria-labelledby="adminTitle" aria-hidden="true">
        <div class="modal-content large">
            <button class="modal-close" onclick="closeModal('adminModal')" aria-label="Close">&times;</button>
            <div class="modal-header">
                <h2 id="adminTitle">Admin Panel</h2>
                <p class="modal-subtitle">Exchange LAB progress leaderboard</p>
            </div>
            <div class="lab-history-modal-content" id="adminContent">
                <!-- Admin content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Offline Indicator -->
    <div class="offline-indicator" id="offlineIndicator" role="alert" aria-live="polite">
        You're offline - some features may be limited
    </div>

    <!-- Load Task Definitions (Exchange LAB only) -->
    <script src="/assets/task-definitions.js"></script>
    
    <!-- Load Tutorial Content -->
    <script src="/assets/tutorials/networking.js"></script>
    <script src="/assets/tutorials/azure.js"></script>
    <script src="/assets/tutorials/microsoft365.js"></script>
    <script src="/assets/tutorials/firewalls.js"></script>
    <script src="/assets/tutorials/backup.js"></script>
    <script src="/assets/tutorials/linux.js"></script>
    <script src="/assets/tutorials/tools.js"></script>

    <!-- Core Application Scripts -->
    <script src="/assets/js/utils.js"></script>
    <script src="/assets/js/api.js"></script>
    <script src="/assets/js/auth.js"></script>
    <script src="/assets/js/ui.js"></script>
    <script src="/assets/js/app.js"></script>

    <!-- PWA Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').then(function(registration) {
                console.log('PWA Service Worker registered successfully:', registration.scope);
            }).catch(function(error) {
                console.log('PWA Service Worker registration failed (optional):', error);
            });
        }
    </script>
</body>
</html>